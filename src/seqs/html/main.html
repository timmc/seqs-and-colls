<!doctype html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Seqs and Colls in Clojure</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>

<h1>Collections and Sequences in Clojure</h1>

<h2>Introduction</h2>
<p>
The topic of collections and sequences in Clojure can be quite confusing
for beginners.
In this document I aim to explain how these two abstractions differ 
and how they work together.
</p>

<p>What I will not cover:</p>

<ul>
  <li>Polymorphism under the collection and sequence APIs
      (e.g. invisible shifts in implementation as you hammer on a coll.)</li>
  <li>Performance characteristics.</li>
</ul>

<h2>Collections</h2>

<figure class="ill">
  <img src="collection-properties-venn.png" width="260" height="314"
       alt="Venn diagram of collection types by properties">
  <figcaption class="ill-cap">Collections divided by properties</figcaption>
</figure>

<p>
A <dfn>collection</dfn> is a bag of values
claiming the <code class="class-c.l">clojure.lang.IPersistentCollection</code> interface.
This may be discovered using the predicate <code class="fn-core">coll?</code>.
Any given collection type may match one or more of the following predicates:</p>

<dl>
  <dt><code class="fn-core">counted?</code></dt>
  <dd>These colls know their size and can calculate their <code>count</code>
      in constant time, without actually traversing their data.</dd>

  <dt><code class="fn-core">associative?</code></dt>
  <dd>Associative colls support key-value lookups.
      Maps are the traditional associative data structure,
      but vectors can be treated as mappings of indices to values.</dd>
  
  <dt><code class="fn-core">sequential?</code></dt>
  <dd>Sequential colls retain a linear ordering under insertion and deletion.
      Lists and vectors have this property.
      Note that a vector is both sequential and associative
      while a set is neither.</dd>
</dl>

<p>There are several types of collection</p>

<div id="tbl-colltypes"></div>

<p>TODO: sorted-set, hash-set, sorted-map, hash-map, array-map</p>

<p>TODO: Raid clojure.core repo for instances of IPersistentCollection, ISeq, etc.</p>

<h2>Sequences</h2>

<p>
A <dfn>sequence</dfn> is a data structure
that is expected to be accessed in a sequential manner.
It may be infinitely long, and may require additional computation
in order to read.
</p>

<div id="tbl-seq"></div>

<p>TODO: seq API</p>

<div id="tbl-seq-remain"></div>

<h2>Relationship between the two</h2>

<ul>
  <li>All sequences are also collections.</li>
  <li>You can derive a sequence backed by any collection.
      Some collections have more than one seq implementation. (rseq [])
      </li>
  <li>You can read any sequence into a new collection.</li>
</ul>

<p>Nota Bene: Sequences are not implemented as lists,
they just act a lot like them and
are may be backed by similar data structures.</p>

<div id="tbl-collseq"></div>

<p>TODO: counted?</p>

<h2>Equality</h2>

<p>TODO: Equality partitions re: seqs and colls</p>

<div id="tbl-eqpart"></div>

<p>TODO: effect of metadata, sortedness</p>

<p>TODO: comparison with other Java Collections</p>

<footer>
<p>
Generated from <a href="https://github.com/timmc/seqs-and-colls">this</a>.
</p>
</footer>

</body>
</html>

